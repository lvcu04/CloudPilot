<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-100">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudPilot Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <style>
        :root { font-family: 'Inter', sans-serif; }
        @supports (font-variation-settings: normal) {
            :root { font-family: 'Inter var', sans-serif; }
        }
    </style>
</head>
<body class="h-full">
    <div class="min-h-full flex">
        <!-- Sidebar -->
        <div class="flex flex-col w-64 bg-gray-800 text-white">
            <div class="flex items-center justify-center h-16 flex-shrink-0 bg-gray-900">
                <svg class="h-8 w-auto text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418" />
                </svg>
                <span class="ml-2 text-xl font-semibold">CloudPilot</span>
            </div>
            <div class="flex-grow flex flex-col overflow-y-auto">
                <nav class="flex-1 px-2 py-4 space-y-1">
                    <a href="#" class="bg-gray-900 text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
                        <svg class="mr-3 h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                        Item Management
                    </a>
                    <a href="#" class="text-gray-300 hover:bg-gray-700 hover:text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
                        <svg class="mr-3 h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        User Directory (LDAP)
                    </a>
                </nav>
            </div>
        </div>

        <!-- Main content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="bg-white shadow-sm">
                <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8">
                    <h1 class="text-lg leading-6 font-semibold text-gray-900">Item Management Dashboard</h1>
                </div>
            </header>
            <main class="flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8">
                <!-- Form to add new items -->
                <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                    <h2 class="text-xl font-semibold mb-4 text-gray-800">Add New Item</h2>
                    <form id="addItemForm" class="flex flex-col sm:flex-row gap-4">
                        <input type="text" id="itemName" placeholder="Enter item name..." required class="flex-grow p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                        <button type="submit" class="bg-indigo-600 text-white font-bold py-3 px-6 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition">Add Item</button>
                    </form>
                    <p id="formMessage" class="text-sm text-red-600 mt-2 h-4"></p>
                </div>

                <!-- Table of items -->
                <div class="bg-white rounded-lg shadow-md">
                    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                        <h2 class="text-xl font-semibold text-gray-800">Database Items</h2>
                        <button id="refreshBtn" class="text-sm font-medium text-indigo-600 hover:text-indigo-800 transition">Refresh List</button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                </tr>
                            </thead>
                            <tbody id="itemTableBody" class="bg-white divide-y divide-gray-200">
                                <!-- Items will be dynamically inserted here -->
                                <tr><td colspan="2" class="px-6 py-4 text-center text-gray-500">Loading items...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        const form = document.getElementById('addItemForm');
        const itemNameInput = document.getElementById('itemName');
        const itemTableBody = document.getElementById('itemTableBody');
        const formMessage = document.getElementById('formMessage');
        const refreshBtn = document.getElementById('refreshBtn');

        async function getItems() {
            itemTableBody.innerHTML = '<tr><td colspan="2" class="px-6 py-4 text-center text-gray-500">Loading...</td></tr>';
            try {
                const response = await fetch('/items');
                if (!response.ok) throw new Error('Failed to fetch items.');
                const items = await response.json();
                
                itemTableBody.innerHTML = '';
                
                if (items.length === 0) {
                    itemTableBody.innerHTML = '<tr><td colspan="2" class="px-6 py-4 text-center text-gray-500">No items found. Add one above!</td></tr>';
                } else {
                    items.forEach(item => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `<td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${item.id}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${item.name}</td>`;
                        itemTableBody.appendChild(tr);
                    });
                }
            } catch (error) {
                itemTableBody.innerHTML = `<tr><td colspan="2" class="px-6 py-4 text-center text-red-500">Error: ${error.message}</td></tr>`;
            }
        }

        async function addItem(event) {
            event.preventDefault();
            const name = itemNameInput.value.trim();
            if (!name) return;
            formMessage.textContent = '';
            try {
                const response = await fetch('/items', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name }),
                });
                if (!response.ok) throw new Error(`Server error: ${response.statusText}`);
                itemNameInput.value = '';
                await getItems();
            } catch (error) {
                formMessage.textContent = error.message;
            }
        }

        form.addEventListener('submit', addItem);
        refreshBtn.addEventListener('click', getItems);
        
        getItems(); // Initial load
    </script>
</body>
</html>